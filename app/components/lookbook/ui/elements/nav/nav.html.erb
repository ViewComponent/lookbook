<%= render component_tag(:nav,
  key: id,
  class: {"with-filter": filter?},
  x: {
    "data": "nav('#{id}')",
    "@page-update:complete.document": "updateSelection(false)",
    "@page-load:complete.document": "updateSelection(true)",
    "@nav:collapse-all.document": "if ($event.detail.id == id) collapseAll()",
    "effect": "filter()"
  }) do %>

  <% if filter? %>
    <div class="nav-filter">
      <input
        placeholder="Filter by name..."
        x-ref="filter"
        x-model="filterText"
        @keydown.esc.stop="clearFilter"
        @keydown.stop>
      </input>
    </div>
  <% end %>

  <div class="nav-tree-wrapper">
    <div class="nav-tree" x-ref="nav">
      <% children.each do |node| %>
        <%= render Lookbook::UI::NavItem.new(node: node) %>
      <% end %>
    </div>
  </div>
<% end %>