<%= render component_tag(x: {data: "previewEmbed"}) do %>
  <%=
    lb_pane(dom_id(target, "embed-preview"),
      class: "embed-preview",
      x: {
        "@viewport:resize-progress": "resizeIframe",
        "@viewport:resize-end": "resizeIframe"
      }
    ) do |pane|
      pane.with_toolbar do |toolbar|
        toolbar.with_label { target.label }
        if display_options.any? && !target.mailer_preview?
          toolbar.with_button_group do |group|
            group.with_button(icon: :settings_2, tooltip: "Display options") do |button|
              button.with_dropdown do
                render Lookbook::UI::DisplayOptionsEditor.new(
                  options: display_options,
                  values: display_options_values
                )
              end
            end
          end
        end
      end

      lb_viewport(target.preview_path(preview_params), id: "embed-viewport-#{target.name}", resize_y: false)
    end
  %>

  <%=
    lb_pane(dom_id(target, "embed-drawer"), class: "embed-drawer") do |pane|
      pane.with_toolbar do |toolbar|
        toolbar.with_tab_group do |group|
          panels.each do |panel|
            group.with_tab(panel.name, label: panel.label, disabled: panel.disabled)
          end
        end
      end

      panels.each do |panel|
        pane.with_tab_panel(panel.name, key: "embed-panel-#{target.name}-#{panel.name}", label: panel.label) do
          render panel.partial, preview: preview, target: target, panel: panel
        end
      end
    end
  %>
<% end %>